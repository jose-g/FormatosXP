@model MGP.CI.SEGURIDAD.Presentacion.ViewModels.LoginViewModel
@{
    Layout = null;
}
<div class="modal-header">
    <h5 class="modal-title" id="exampleModalCenterTitle" style="color:white">Cambio de clave</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true" style="color:white"><i class="glyphicon glyphicon-remove"></i><span class="menu-title"></span></span>
    </button>
</div>

@using (Html.BeginForm("CambiarClave", "Usuario", FormMethod.Post, new { id = "FrmCambiarClave", onsubmit = "return grabarCambioClave(this)" }))
{
    <div class="modal-body">
        @Html.HiddenFor(x => x.UsuarioId)


        <input type="hidden" id="id_usuario" value="@Model.UsuarioId" />

        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div class="form-group">
                    @Html.LabelFor(x => x.UsuarioNombre, new { @class = "control-label" })
                    @Html.TextBoxFor(x => x.UsuarioNombre, new { @readonly = "readonly", @class = "form-control" })
                </div>
                <div class="form-group">
                    @Html.LabelFor(x => x.Login, new { @class = "control-label" })
                    @Html.TextBoxFor(x => x.Login, new { @readonly = "readonly", @class = "form-control" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-12" style="border:1px solid lightgray">
                <div class="row" style="margin-bottom:5px;margin-top:10px">
                    <div class="col-sm-12 col-md-6 col-lg-3" style="text-align: right">
                        @Html.LabelFor(x => x.PasswordOld, new { @class = "control-label" })
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-9">
                        @Html.TextBoxFor(x => x.PasswordOld, new { @class = "form-control", @readonly = "readonly", placeholder = "Password", @type = "password" })
                    </div>
                </div>

                <hr />

                <div class="row" style="margin-bottom:5px;margin-top:10px">
                    <div class="col-sm-12 col-md-6 col-lg-3" style="text-align: right">
                        <label class="control-label">Contraseña nueva:</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-9">
                        @Html.TextBoxFor(x => x.Password, new { @class = "form-control", placeholder = "New Password", @type = "password" })
                    </div>
                </div>
                <div class="row" style="margin-bottom:10px;margin-top:5px">
                    <div class="col-sm-12 col-md-6 col-lg-3" style="text-align: right">
                        <label class="control-label">Repetir Contraseña :</label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-9">
                        @Html.TextBoxFor(x => x.PasswordRepeat, new { @class = "form-control", placeholder = "Repeat Password", @type = "password" })
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer text-right">
        <div class="row">
            <div class="col-sm-7 col-md-7 col-lg-8" style="text-align: justify">
                <i>La contraseña debe ser mayor a 6 caracteres con distinción entre mayuscula y minuscula.</i>
            </div>
            <div class="col-sm-5 col-md-5 col-lg-4">
                <button id="btnGrabarCambioClave" type="submit" class="btn btn-warning"><i class="fa fa-save"></i>&nbsp;Grabar</button>
                <button id="btnCerrarFrmRst" type="button" data-dismiss="modal" class="btn btn-danger"><i class="fa fa-times"></i>&nbsp;Cerrar</button>
            </div>
        </div>

    </div>
}
<div class="alert_error" style="display:none;" id="frmShowErrorPopupRsKey_2">
</div>



@section Scripts{

    <script>

   
         @*function GrabarMantClave(formulario) {

         if ($("form#frmCambioClave #Login").val() == null || $("form#frmCambioClave #Login").val().trim() == "") {
             $("#frmShowErrorPopupRsKey").html("Ingrese su login").show();
             $("form#frmCambioClave #Login").focus();
             return false;
         }

         if ($("form#frmCambioClave #Password").val() != $("form#frmCambioClave  #PasswordRepeat").val()) {
             $("#frmShowErrorPopupRsKey").html("Las contraseñas no coinciden, vuelva a intentarlo").show();
             $("form#frmCambioClave #Password").val('');
             $("form#frmCambioClave #PasswordRepeat").val('');
             $("form#frmCambioClave #Password").focus();
             return false;
             }



         var f = new FormData(formulario);

         $.ajax({
             url: "@Url.Action("CambiarClaveUsuario", "Usuario")",
             type: "POST",
             data: f,
             processData: false,
             contentType: false,
             cache: false,
         success: function (data) {
             if (data.success == true) {
                 $.notify("Operación satisfactoria..", "success");
                 $('#verModalCambioClave').html('').modal('hide');
             } else {
                 $("#frmShowErrorPopupRsKey").html(data.mensajeError).show();
                 $.notify("Ocurrio un error", "error");
             }
         },
         error: function (data) {
             console.log("Sucedió un error")
         }
     });

         return false;
     }*@

    </script>
}
